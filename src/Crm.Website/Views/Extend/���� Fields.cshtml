@using Crm.Api;
<table>
@for (int count = 0; count < this.ViewBag.fields.Count; ++count)
{
    string dataRequiredAttr = "";
    FieldInfo field = this.ViewBag.fields[count];
    if (count % 2 == 0)
    {
        @this.Html.Raw("<tr>");
    } 
<td>
<div class="control-group">
    <label class="control-label">
        @field.Name
    </label>
    <div class="controls">
    @if (field.Required) { 
        dataRequiredAttr = "data-required = 'true'";
    }
    @switch (field.Type)
    {
        case FieldType.String:
            StringFieldInfo stringField = ((StringFieldInfo)field);
            <input type="text" name="@string.Format("field{0}", field.ID)" @this.Html.Raw(dataRequiredAttr) value="@stringField.DefaultValue"/>
            break;
        case FieldType.Text:
            TextFieldInfo textField = ((TextFieldInfo)field);
            <textarea name="@string.Format("field{0}", field.ID)" @this.Html.Raw(dataRequiredAttr) rows="3" >@textField.DefaultValue</textarea>
            break;
        case FieldType.Dropdown:
            DropdownFieldInfo dropdownFieldInfo = ((DropdownFieldInfo)field);
            <select @this.Html.Raw(dataRequiredAttr) name="@string.Format("field{0}", field.ID)">
                <option></option>
                @foreach (string item in dropdownFieldInfo.SelectList)
                {
                    if (item == dropdownFieldInfo.DefaultValue)
                    {
                    <option selected="selected">@item</option>
                    }
                    else
                    {
                    <option>@item</option>    
                    }
                }
            </select>
            break;
    }
        @if (field.Required) { 
            <font style="color: Red">*</font>
        }
    </div>
</div>
</td>
    if(count % 2 == 1)
    {
        @this.Html.Raw("</tr>");
    }
    else if(count == this.ViewBag.fields.Count - 1)
    {
        @this.Html.Raw("<td></td></tr>");
    }
}
</table>